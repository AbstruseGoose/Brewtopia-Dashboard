<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Brewtopia Dashboard</title>

<style>
  body {
    margin: 0;
    background: #141414;
    color: #ffffff;
    font-family: "Segoe UI", Roboto, sans-serif;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* --- Hourly Forecast Strip --- */
  .forecast-bar {
    width: 100%;
    white-space: nowrap;
    overflow-x: auto;
    overflow-y: hidden;
    background: #1f1f1f;
    padding: 8px 0;
    display: flex;
    gap: 12px;
    border-bottom: 2px solid #333;
  }
  .hour-block {
    flex: 0 0 auto;
    background: #2a2a2a;
    padding: 6px 10px;
    border-radius: 10px;
    text-align: center;
    color: #fff;
    min-width: 75px;
  }
  .hour-block img {
    width: 40px;
    height: 40px;
  }

  /* --- Main clocks/weather label --- */
  header {
    margin-top: 8px;
    font-size: 1.6em;
  }
  .time {
    font-size: 1.8em;
    margin: 8px 0;
  }
  .current-weather {
    font-size: 1.2em;
    margin-bottom: 15px;
  }

  /* --- Cameras --- */
  .camera-container {
    display: flex;
    justify-content: center;
    gap: 20px;
    flex-wrap: wrap;
  }
  .camera {
    background: #000;
    border-radius: 10px;
    overflow: hidden;
  }
  .camera img {
    width: 400px;
    height: 225px;
    object-fit: cover;
  }

  footer {
    position: absolute;
    bottom: 5px;
    font-size: 0.9em;
    color: #777;
  }
</style>
</head>

<body>

  <!-- HOURLY FORECAST STRIP -->
  <div class="forecast-bar" id="forecast"></div>

  <header>Brewtopia Coffee Trailer Dashboard</header>
  <div class="time" id="time"></div>
  <div class="current-weather" id="currentWeather">Loading weather...</div>

  <!-- CAMERAS -->
  <div class="camera-container">
    <div class="camera">
<img id="cam1" src="http://admin:An794613$$@192.168.1.91/cgi-bin/mjpg/video.cgi?channel=1&subtype=1&t=1">
<img id="cam2" src="http://admin:An794613$$@192.168.1.71/cgi-bin/mjpg/video.cgi?channel=1&subtype=1&t=2">
    </div>
  </div>

  <footer>Weather updates hourly â€¢ Page reloads every 60 minutes</footer>


<script>
/* --- CLOCK --- */
function updateClock() {
  const now = new Date();
  document.getElementById("time").textContent =
    now.toLocaleTimeString([], {hour: "2-digit", minute: "2-digit"}) +
    " â€” " +
    now.toLocaleDateString([], {weekday: "long", month: "short", day: "numeric"});
}
setInterval(updateClock, 1000);
updateClock();

/* --- WEATHER CONFIG --- */
const apiKey = "ce57b328ddd2af95c06b77dc11a49bf6";  // <---- Replace this
const lat = 36.2037;  // Andersonville TN
const lon = -84.0680;

/* --- FETCH WEATHER --- */
function fetchWeather() {
  const url = `https://api.openweathermap.org/data/3.0/onecall?lat=${lat}&lon=${lon}&units=imperial&appid=${apiKey}`;

  fetch(url)
    .then(r => r.json())
    .then(data => {
      /* --- Current Weather --- */
      const cw = data.current;
      document.getElementById("currentWeather").innerHTML =
        `Andersonville: ${Math.round(cw.temp)}Â°F â€” ${cw.weather[0].main}`;

      /* --- Hourly Forecast Strip (next 12 hours) --- */
      const fc = document.getElementById("forecast");
      fc.innerHTML = ""; // clear old blocks

      for (let i = 0; i < 12; i++) {
        const hour = data.hourly[i];
        const block = document.createElement("div");
        block.className = "hour-block";

        const date = new Date(hour.dt * 1000);
        const hourString = date.toLocaleTimeString([], { hour: "numeric" });

        block.innerHTML = `
          <div>${hourString}</div>
          <img src="https://openweathermap.org/img/wn/${hour.weather[0].icon}@2x.png">
          <div>${Math.round(hour.temp)}Â°F</div>
        `;

        fc.appendChild(block);
      }
    })
    .catch(err => {
      document.getElementById("currentWeather").textContent =
        "Weather unavailable";
      console.error(err);
    });
}

fetchWeather();
setInterval(fetchWeather, 60 * 60 * 1000); // hourly refresh

/* --- Auto Page Reload --- */
setTimeout(() => location.reload(), 60 * 60 * 1000);
</script>

</body>
</html>